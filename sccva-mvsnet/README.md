The C++ code will be release later.

# SCCVA-MVSNet
This folder contains the training and evaluation code for SCCVA-MVSNet.
This repo is build on [TANDEM](https://github.com/tum-vision/tandem).


### Video
[YouTube](https://youtu.be/CMhcLmH12_Q)

### Install
Create a conda environment and install requirements
```
conda create -n tandem python=3.7
conda activate tandem
conda install pytorch==1.7.1 torchvision==0.6.1 cudatoolkit=11.1 -c pytorch

pip install -r requirements.txt
```

**Comment:** The environment uses PyTorch `1.7.1` and PyTorch-Lightning `0.7.6` because this was the environment we used for development. However, we don't use features specific to this PyTorch version and thus an upgrade should hopefully be easy. On the other hand, PyTorch-Lightning introduced significant breaking changes and upgrading could be more cumbersome. Our model is defined in `models/cva_mvsnet.py` and wrapped by PyTorch-Lightning in `models/tandem.py` s.t. removing PyTorch-Lightning from the project should be possible.

**Reproducibility:** The `requirements.txt` does not contain version numbers for packages like `numpy` where we do not expect breaking changes. For reproducibility we include `reproducibility/requirements_conda.txt` and `reproducibility/requirements_pip.txt` with exact version numbers that were generated by `pip freeze` and `conda list --export`, respectively.

### Training
Config values are documented in `config/default.yaml`. 

```
python train.py --config config/default.yaml path/to/out/folder DATA.ROOT_DIR YOUR_DATA_DIR
```
where `path/to/out/folder` may not exist and will contain tensorboard logs and checkpoints. You can overwrite more config parameters by listing them at the end of the command, e.g. `TRAIN.EPOCHS 100`.

# Acknowledgements
We thank Xiaodong Gu, Zhiwen Fan, Zuozhuo Dai, Siyu Zhu, Feitong Tan, and Ping Tan for open sourcing their excellent work ["Cascade Cost Volume for High-Resolution Multi-View Stereo and Stereo Matching"](https://github.com/alibaba/cascade-stereo).
Koestler L, Yang N, Zeller N, Cremers D. ["TANDEM: Tracking and Dense Mapping in Real-time using Deep Multi-view Stereo"](https://github.com/tum-vision/tandem).
and Eldesokey, Abdelrahman, Michael Felsberg, and Fahad Shahbaz Khan. ["Confidence propagation through cnns for guided sparse depth regression."](https://github.com/abdo-eldesokey/nconv)

